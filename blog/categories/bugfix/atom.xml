<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: bugfix | Musings of Parker J. Moore]]></title>
  <link href="http://blog.parkermoore.de/blog/categories/bugfix/atom.xml" rel="self"/>
  <link href="http://blog.parkermoore.de/"/>
  <updated>2014-06-23T13:29:13-04:00</updated>
  <id>http://blog.parkermoore.de/</id>
  <author>
    <name><![CDATA[Parker J. Moore]]></name>
    <email><![CDATA[parkrmoore@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Fixing Memory Issues in Dokku hosted on DigitalOcean 512MB Droplet]]></title>
    <link href="http://blog.parkermoore.de/2013/12/21/fixing-memory-issues-in-dokku-hosted-on-digitalocean-512mb-droplet/"/>
    <updated>2013-12-21T12:23:00-05:00</updated>
    <id>http://blog.parkermoore.de/2013/12/21/fixing-memory-issues-in-dokku-hosted-on-digitalocean-512mb-droplet</id>
    <content type="html"><![CDATA[<p>As many other Heroku customers, I rejoiced when <a href="https://github.com/progrium/dokku">Dokku</a> was released. To have
complete freedom to host as many apps with whatever databases or other plugins
I wanted -- all for the cost of a small VM -- was wonderful news.</p>

<p>I decided, for cost&#39;s sake, to boot up one of those famed $5 <a href="https://digitalocean.com">DigitalOcean</a>
Droplets. I didn&#39;t see that DigitalOcean provides an &quot;app&quot; for Dokku, so I
created a vanilla box of Ubuntu 13.04 and pressed on. I got everything up and
running and went to go deploy my first app, only to see this when I ran
<code>git push</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">runtime: panic before malloc heap initialized
fatal error: runtime: cannot allocate heap metadata
</code></pre></div>
<p>Well, golly, that sure is unhelpful. Looks like 512MB doesn&#39;t cut it. Luckily,
we can avoid paying the extra $5/mo for the 1GB version by running the following
as <code>root</code>:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/extraswap <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span>512
mkswap /extraswap
</code></pre></div>
<p>Then adding the following to your <code>/etc/fstab</code> file so the swap persists between
reboots:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">/extraswap         none            swap    sw                0       0
</code></pre></div>
<p>Then run this to enable <code>/extraswap</code> for swapping:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">swapon -a
</code></pre></div>
<p>Boom. Now re-run <code>git push</code> and you&#39;re in business. Magic!</p>

<p>Credit goes to the brilliant <a href="https://github.com/dhassler">@dhassler</a> for <a href="https://github.com/dotcloud/docker/issues/1555#issuecomment-22874190">the idea and the code</a>. Just
thought I&#39;d share and preserve for my own benefit in the future.</p>
]]></content>
  </entry>
  
</feed>
